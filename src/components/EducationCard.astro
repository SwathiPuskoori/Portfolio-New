---
import { Image } from 'astro:assets'
import type { ImageMetadata } from 'astro'
import { cn } from '@/utils'

const {
  degree,         // e.g. "Master of Computer Science"
  institution,    // e.g. "Illinois Institute of Technology"
  location,       // e.g. "Chicago, IL"
  date,           // e.g. "Aug 2022 â€“ May 2024"
  logoPath,       // optional logo image
  logoAlt,        // alt text for logo
  websiteUrl,     // optional institution link
  imageClass,
  class: className,
} = Astro.props

const images = import.meta.glob<{ default: ImageMetadata }>('/src/assets/*.{jpeg,jpg,png,gif,webp}')

if (logoPath && !images[logoPath]) {
  throw new Error(`"${logoPath}" does not exist in src/assets/*.{jpeg,jpg,png,gif,webp}`)
}
---

<div
  class={cn(
    'relative flex flex-col rounded-2xl border border-border bg-primary-foreground px-5 py-4 shadow-sm transition-all hover:shadow-md hover:border-border/80',
    className
  )}
>
  <div class="flex flex-row items-center gap-x-4">
    {logoPath && (
      <div class="flex-shrink-0 flex items-center justify-center w-14 h-14 overflow-hidden">
        {websiteUrl ? (
          <a
            href={websiteUrl}
            target="_blank"
            rel="noopener noreferrer"
            class="inline-flex items-center justify-center w-full h-full"
          >
            <Image
              src={images[logoPath]()}
              alt={logoAlt ?? institution}
              class={cn('h-10 w-auto object-contain transition-transform duration-200 hover:scale-105', imageClass)}
              loading="eager"
            />
          </a>
        ) : (
          <Image
            src={images[logoPath]()}
            alt={logoAlt ?? institution}
            class={cn('h-10 w-auto object-contain', imageClass)}
            loading="eager"
          />
        )}
      </div>
    )}

    <div class="flex flex-col">
      <h1 class="text-base font-semibold text-foreground leading-snug">{degree}</h1>
      <p class="text-sm text-muted-foreground">{institution}</p>
      {location && <p class="text-xs text-muted-foreground">{location}</p>}
      {date && <p class="text-xs text-muted-foreground mt-1">{date}</p>}
    </div>
  </div>
</div>
